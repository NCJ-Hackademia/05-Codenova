<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2D Design - Live N Fit</title>
    <meta name="description" content="Visualize your home with our intuitive 2D design tools. Create and customize your floor plans with ease." />
    <link rel="stylesheet" href="../css/main.css" />
    <style>
        .svg-floorplan {
            background: #f8fafc;
            border: 2px solid #e5e7eb;
            border-radius: 1rem;
            margin: 0 auto 2rem auto;
            display: block;
        }
        .details-box {
            background: #f3f4f6;
            border-radius: 1rem;
            padding: 1.5rem;
            margin: 0 auto 2rem auto;
            max-width: 600px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }
        .details-box h2 {
            font-size: 1.3rem;
            font-weight: bold;
            color: #3730a3;
            margin-bottom: 1rem;
        }
        .details-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .details-list li {
            margin-bottom: 0.5rem;
            color: #374151;
        }
        .action-btns {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 2rem;
        }
        .btn-main {
            background: #6366f1;
            color: #fff;
            font-weight: bold;
            padding: 0.75rem 2.5rem;
            border-radius: 0.75rem;
            border: none;
            font-size: 1.1rem;
            cursor: pointer;
            transition: background 0.2s;
        }
        .btn-main:hover {
            background: #4338ca;
        }
        .btn-secondary {
            background: #f3f4f6;
            color: #6366f1;
            font-weight: bold;
            padding: 0.75rem 2.5rem;
            border-radius: 0.75rem;
            border: 2px solid #6366f1;
            font-size: 1.1rem;
            cursor: pointer;
            transition: background 0.2s, color 0.2s;
        }
        .btn-secondary:hover {
            background: #6366f1;
            color: #fff;
        }
    </style>
</head>
<body class="bg-background font-body">
    <!-- Navigation Header (copied from design_form_portal) -->
    <nav class="bg-surface shadow-card sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo -->
                <div class="flex items-center">
                    <a href="{{url_for('homepage')}}" class="flex flex-col items-start space-y-0.5 space-x-2">
                        <span class="flex items-center space-x-2">
                            <svg class="w-8 h-8 text-secondary" viewBox="0 0 32 32" fill="currentColor">
                                <path d="M16 2L4 12v18h8v-8h8v8h8V12L16 2zm0 4.5L24 14v14h-4v-8H12v8H8V14l8-7.5z"/>
                                <circle cx="16" cy="18" r="2" fill="currentColor"/>
                            </svg>
                            <span class="font-headline font-bold text-xl text-primary">Live N Fit</span>
                        </span>
                        <span class="text-sm text-text-secondary font-medium mt-1">
                            {% if session['user_name'] %}
                                Welcome {{ session['user_name'] }}!
                            {% endif %}
                        </span>
                    </a>
                </div>
                <!-- Desktop Navigation -->
                <div class="hidden md:flex items-center space-x-8">
                    <a href="{{ url_for('homepage') }}" class="text-text-secondary hover:text-primary transition-quick">Home</a>
                    <a href="{{ url_for('about') }}" class="text-text-secondary hover:text-primary transition-quick">About</a>
                    <a href="{{ url_for('design_portal') }}" class="text-text-secondary hover:text-primary transition-quick">Design</a>
                    <a href="{{ url_for('design_2d') }}" class="text-primary font-semibold border-b-2 border-secondary">2D Design</a>
                    <a href="{{ url_for('pricing') }}" class="text-text-secondary hover:text-primary transition-quick">Pricing</a>
                    <a href="{{ url_for('designs_gallery') }}" class="text-text-secondary hover:text-primary transition-quick">My Designs</a>
                    <a href="{{ url_for('tech_deep_dive') }}" class="text-text-secondary hover:text-primary transition-quick">Technology</a>
                    <a href="{{ url_for('contact') }}" class="text-text-secondary hover:text-primary transition-quick">Contact</a>
                </div>
                <!-- Save Progress Button -->
                <div class="hidden md:block">
                    <button class="text-secondary font-semibold hover:text-secondary-600 transition-quick">
                        Save Progress
                    </button>
                </div>
                <!-- Mobile Menu Button -->
                <div class="md:hidden">
                    <button id="mobile-menu-btn" class="text-primary hover:text-secondary transition-quick">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="md:hidden hidden bg-surface border-t border-border">
            <div class="px-4 py-2 space-y-2">
                <a href="{{ url_for('homepage') }}" class="block py-2 text-text-secondary hover:text-primary transition-quick">Home</a>
                <a href="{{ url_for('about') }}" class="block py-2 text-text-secondary hover:text-primary transition-quick">About</a>
                <a href="{{ url_for('design_portal') }}" class="block py-2 text-text-secondary hover:text-primary transition-quick">Design</a>
                <a href="{{ url_for('design_2d') }}" class="block py-2 text-primary font-semibold">2D Design</a>
                <a href="{{ url_for('pricing') }}" class="block py-2 text-text-secondary hover:text-primary transition-quick">Pricing</a>
                <a href="{{ url_for('designs_gallery') }}" class="block py-2 text-text-secondary hover:text-primary transition-quick">My Designs</a>
                <a href="{{ url_for('tech_deep_dive') }}" class="block py-2 text-text-secondary hover:text-primary transition-quick">Technology</a>
                <a href="{{ url_for('contact') }}" class="block py-2 text-text-secondary hover:text-primary transition-quick">Contact</a>
                <button class="block py-2 mt-4 text-secondary font-semibold">Save Progress</button>
            </div>
        </div>
    </nav>

    <main>
        <section class="py-12 bg-background">
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
                <!-- 2D Floor Plan SVG -->
                <div id="svg-container"></div>

                <!-- Work in Progress Message -->
                <div style="text-align:center; margin-bottom:1.5rem;">
                    <span class="inline-block bg-yellow-100 text-yellow-800 px-4 py-2 rounded-lg font-semibold text-lg shadow">
                        Working on your design... (In Progress)
                    </span>
                </div>

                <!-- User Details -->
                <div class="details-box">
                    <h2>Your Design Details</h2>
                    <ul class="details-list" id="details-list">
                        <!-- Details will be populated by JavaScript -->
                    </ul>
                </div>

                <!-- Action Buttons -->
                <div class="action-btns">
                    <button class="btn-secondary" id="generate-btn" type="button">Generate Design</button>
                    <button class="btn-main" id="proceed-btn" type="button">Proceed</button>
                </div>
            </div>
        </section>
    </main>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Get design data from localStorage
        const designData = JSON.parse(localStorage.getItem('designData'));
        if (!designData || !designData.area || !designData.floors || !designData.rooms || !designData.style) {
            alert('No design data found. Please go back and fill the design form.');
            window.location.href = "{{ url_for('design_portal') }}";
            return;
        }

        // Generate a simple SVG floor plan based on area, rooms, floors
        function generateSVG(data) {
            // Calculate width and height based on area and floors
            const width = Math.min(600, Math.max(300, parseInt(data.area) / 10));
            const floorHeight = 60;
            const height = 60 + (parseInt(data.floors) * floorHeight);

            let svg = `<svg width="${width}" height="${height}" class="svg-floorplan" xmlns="http://www.w3.org/2000/svg">`;
            for (let f = 0; f < parseInt(data.floors); f++) {
                svg += `<rect x="10" y="${20 + f * floorHeight}" width="${width - 20}" height="50" fill="#e2e8f0" stroke="#4c51bf" stroke-width="2"/>`;
                svg += `<text x="${width / 2}" y="${50 + f * floorHeight}" text-anchor="middle" font-size="18" fill="#4c51bf">Floor ${f + 1}</text>`;
            }
            svg += `<text x="${width / 2}" y="${height - 10}" text-anchor="middle" font-size="16" fill="#2d3748">Rooms: ${data.rooms}, Style: ${data.style}</text>`;
            svg += `</svg>`;
            document.getElementById('svg-container').innerHTML = svg;
        }

        // Show details
        function updateDetails(data) {
            document.getElementById('details-list').innerHTML = `
                <li><strong>Area:</strong> ${data.area} sq ft</li>
                <li><strong>Floors:</strong> ${data.floors}</li>
                <li><strong>Rooms:</strong> ${data.rooms}</li>
                <li><strong>Style:</strong> ${data.style}</li>
            `;
        }

        // Render the design and details
        generateSVG(designData);
        updateDetails(designData);

        // Proceed button: Save for pricing
        document.getElementById('proceed-btn').addEventListener('click', function() {
            localStorage.setItem('floorPlan', JSON.stringify(designData));
            window.location.href = "{{ url_for('pricing') }}";
        });
    });
    </script>
</body>
</html>